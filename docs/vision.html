<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Pieter-Jan Cassiman">
    <meta name="description" content="My corner of the internet">
    <title>Thesis</title>
    <link rel="icon" type="image/png" href="https://pcassima.github.io/assets/img/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://pcassima.github.io/assets/css/main.css">
    <link rel="stylesheet" type="text/css" href="https://pcassima.github.io/assets/css/additional.css">
    <link rel="stylesheet" type="text/css" href="assets/css/styling.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/addons/p5.dom.min.js"></script>
    <script src="https://pcassima.github.io/js/nav.js"></script>
    <script src="https://pcassima.github.io/js/modal.js"></script>
  </head>
  <body>
    <header>
      <div class="top-triangle">
        <div class="triangle-topright-1"></div>
        <div class="triangle-topright-2"></div>
        <div class="triangle-topright-3"></div>
      </div>
      <div><span class="main">Computer vision</span><span class="sub">-- the link between VR and the physical world</span></div>
    </header>
    <nav>
      <div class="hamburger" id="hamburger" onclick="hamburgerNav()">
        <div class="hamburger-bar" id="h-bar1"></div>
        <div class="hamburger-bar" id="h-bar2"></div>
        <div class="hamburger-bar" id="h-bar3"></div>
      </div>
      <ul class="nav-list" id="nav-list">
        <li><a href="https://pcassima.github.io/">Home</a></li>
        <li><a class="nav_active" href="https://pcassima.github.io/projects.html">Projects</a></li>
        <li><a href="#">Experiments</a></li>
        <li><a href="https://pcassima.github.io/gallery.html">Gallery</a></li>
        <li><a href="https://pcassima.github.io/about.html">About</a></li>
        <li><a href="https://pcassima.github.io/contact.html">Contact</a></li>
      </ul>
    </nav>
    <aside class="left">
      <ol>
        <li><a href="index.html">Introduction</a></li>
        <li><a href="outline.html">Outline</a></li>
        <li><a href="vision.html">Vision</a>
          <ol>
            <li><a href="vision.html#vision-camera">Camera</a></li>
            <li><a href="vision.html#vision-system">System</a></li>
            <li><a href="vision.html#vision-framework">Framework</a></li>
            <li><a href="vision.html#vision-program">Program</a></li>
          </ol>
        </li>
        <li><a href="linefollower.html">Linefollower</a>
          <ol>
            <li><a href="linefollower.html#LF-hardware">Hardware</a></li>
            <li><a href="linefollower.html#LF-software">Software</a></li>
          </ol>
        </li>
        <li><a href="controllable_car.html">Car</a>
          <ol>
            <li><a href="controllable_car.html#CC-prototype">Prototype</a></li>
            <li><a href="controllable_car.html#CC-hardware">Hardware</a></li>
            <li><a href="controllable_car.html#CC-software">Software</a></li>
            <li><a href="controllable_car.html#CC-oled">OLED</a></li>
          </ol>
        </li>
        <li><a href="controllers.html">Controllers</a></li>
        <li><a href="link.html">Link</a>
          <ol>
            <li><a href="link.html#L-protocol">Protocol</a></li>
            <li><a href="link.html#L-lights">Lights</a></li>
            <li><a href="link.html#L-further">Further</a></li>
          </ol>
        </li>
        <li><a href="makerfaire.html">Maker Faire</a></li>
        <li><a href="conclusion.html">Conclusion</a></li>
        <li><a href="extra.html">Extra</a>
          <ol>
            <li><a href="extra.html#E-PID">PID</a></li>
            <li><a href="extra.html#E-vision">Vision</a></li>
            <li><a href="extra.html#E-raspbian">Raspbian</a></li>
          </ol>
        </li>
      </ol>
    </aside>
    <aside class="right"></aside>
    <main>
      <article>
        <h1>Vision</h1>
        <blockquote cite="ftp://publications.ai.mit.edu/ai-publications/pdf/AIM-858.pdf">
          <q>
            For both biological systems and machines, vision begins with a large and
            unwieldy array of measurements of the amount of light reflected from
            surfaces in the environment. The goal of vision is to recover physical
            properties of objects in the scene, such as the location of object boundaries
            and the structure, color and texture of object surfaces, from the two-dimensional image
            that is projected onto the eye or camera. This goal is not
            achieved in a single step; vision proceeds in stages, with each stage
            producing increasingly more useful descriptions of the image and then the
            scene. The first clues about the physical properties of the scene are provided
            by the changes of intensity in the image.
          </q>
          <p>(Hildreth, 1985)</p>
        </blockquote>
        <section id="vision-camera">
          <h2>Camera</h2>
          <p>
            Any vision system requires an input of data. In this case that will be a camera.
            Practically any camera can be used, as long as there is a way to
            (reliably) get the data from the camera to the computer for processing.
          </p>
          <p>A few examples of camera interfaces that can be used:
            <ul class="fa-ul">
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>USB</li>
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>Ethernet</li>
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>HDMI</li>
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>SDI</li>
            </ul>
          </p>
          <h3>USB-camera</h3>
          <p>
            However a USB-camera is in most cased the most convenient (and cheapest)
            option. These days USB-camera's can be easily found everywhere.
            From cheap webcams to CMOS-camera intended for use with microscopes.
          </p>
          <p>
            This system was developed and tested with a (cheap) Logitech USB-webcam.
            To illustrate that good result can be achieved even on moderate hardware.
          </p>
          <h3>Raspberry Pi Camera module</h3>
          <p>
            Due to the versatile nature of the library (an entire system). The computer-vision system can
            also be easily ran on a Raspberry Pi with the Raspberry Pi camera module.<br>In order to achieve this, the camera interface has to be enabled, a few dependencies must be
            installed on the Raspberry Pi and a few line have to be changed in the program.
            These lines mostly have to do with the initialization of the camera object. The rest of the
            program stays unchanged.
          </p>
          <h4>Enabling the camera interface</h4>
          <figure class="generic_photo"><img src="assets/img/thesis/raspbian/rasbian_1.png" alt="raspi-config" onclick="open_modal(&quot;modal-box-1&quot;)">
            <figcaption>raspi-config</figcaption>
          </figure>
          <div class="modal-box" id="modal-box-1" onclick="close_modal(&quot;modal-box-1&quot;)">
            <!--.close-button(onclick='close_modal("modal-box-1")')-->
            <div class="image-modal-container"><img src="assets/img/thesis/raspbian/rasbian_1.png">
              <figcaption>Raspberry Pi configuration screen</figcaption>
            </div>
          </div>
          <p>
            The first thing that needs to be done in order to use the Raspberry Pi camera module is
            enable the camera interface. This can be done via the Raspbian configuration screen.<br>This screen can be accessed by opening a terminal and calling the following command:
          </p>
          <pre><code><span class="terminal-first-highlight">sudo</span> raspi-config</code></pre>
          <p>
            This will open the configuration screen in the terminal, with a blue background. This screen
            can be navigated using both the keyboard and the mouse. Each setting has an associated
            keyboard shortcut that can be pressed for quicker navigation.
            The setting to enable the camera interface can be found under <em>interfacing options</em>.
          </p>
          <figure class="generic_photo"><img src="assets/img/thesis/raspbian/rasbian_2.png" alt="raspi-config" onclick="open_modal(&quot;modal-box-2&quot;)">
            <figcaption>raspi-config</figcaption>
          </figure>
          <div class="modal-box" id="modal-box-2" onclick="close_modal(&quot;modal-box-2&quot;)">
            <!--.close-button(onclick='close_modal("modal-box-2")')-->
            <div class="image-modal-container"><img src="assets/img/thesis/raspbian/rasbian_2.png">
              <figcaption>Raspberry Pi configuration screen</figcaption>
            </div>
          </div>
          <h4>Dependencies for using the camera module</h4>
        </section>
        <section id="vision-system">
          <h2>System</h2>
          <div class="table-container">
            <table>
              <caption>Minimum system requirements</caption>
              <tr>
                <th>Spec</th>
                <th>Value</th>
              </tr>
              <tr>
                <td>RAM</td>
                <td>1 GB</td>
              </tr>
              <tr class="alt">
                <td>CPU speed</td>
                <td>1 GHz</td>
              </tr>
              <tr>
                <td>CPU cores</td>
                <td>2 cores</td>
              </tr>
              <tr class="alt">
                <td>Storage</td>
                <td>8 GB</td>
              </tr>
            </table>
          </div>
        </section>
        <section id="vision-framework">
          <h2>Framework</h2>
          <h3>Language</h3>
          <div class="generic-card card-accent-1">
            <blockquote cite="ftp://publications.ai.mit.edu/ai-publications/pdf/AIM-858.pdf">
              <q>Python is powerful... and fast;<br>plays well with others;<br>runs everywhere;<br>is friendly & easy to learn;<br>is Open.</q>
              <p>(The Python Software Foundation, sd)</p>
            </blockquote>
          </div>
          <p>
            Python is an enormously popular programming language, especially in scientific context.
            As a result there are a lot of modules and libraries available. There is at least one for
            pretty much any application.
          </p>
          <p>Python can be found at: <a href="https://python.org" target="_blank">Python</a>.</p>
          <p>
            This language was chosen for various reasons. The most important one being the vast community
            and documentation Python has. Our previous knowledge of Python also helped chose this
            language.
            Python programs and reads easily, which makes it easy for others to read and modify the code.
          </p>
          <p>
            Because of the object-oriented approach of Python, the code can easily be split into several
            sections, each responsible for their own task.
            By splitting up the code into smaller sections, the code becomes easier to debug, modify and
            reuse.
          </p>
          <p>
            PyPi (<em>Python Package Index</em>) is Python's module-manager and it contains thousands of
            modules. These can be easily installed via PIP (<em>Package Installer for Python</em>).
          </p>
          <p>
            For this project Python 3 was used, specifically <em>Python 3.7.2 64bit</em>. At the moment
            of testing the software, this was the latest version.
          </p>
          <h3>Libraries</h3>
          <p>
            In order to make everything work as intended, a few libraries are required.
            Each library will be discussed with a bit of detail and background.
          </p>
          <h4>NumPy</h4>
          <p>
             NumPy is a very powerful module, that is commonly used in scientific context for processing
            large amounts of data. The most known aspect of NumPy are the N-dimensional arrays
            (matrices). These array and operations on them are implemented in a really efficient way,
            making these really fast and efficient to use, even with larger arrays and multiple
            dimensions.
          </p>
          <p>
            Many of the other Python modules use NumPy to implement their datastructures. In this project
            NumPy is used to save the pixel-values of each frame and intermediate results.
            This allows to quickly isolate parts of the frame and further process them.
          </p>
          <p>NumPy can be installed using the following command:</p>
          <pre><code><span class="terminal-first-highlight">pip</span> install numpy</code></pre>
          <h4>Imutils</h4>
          <p>
            Imutils os a relatively small module for Python. This module simplifies moving, rotationg and
            scaling images. There is also a functionality to correctly format the contours, found by
            OpenCV. It is this functionality that is being used in the program.
          </p>
          <pre><code><span class="terminal-first-highlight">pip</span> install imutils</code></pre>
          <h4>OpenCV</h4>
          <p>
            To read in the frames and process them, OpenCV (<em>Open source Computer Vision library</em>)
            is used. This is a library for image processing and -recognition. OpenCv is a popular library,
            used by companies such as Google, Microsoft, Intel, IBM and Sony.
          </p>
          <p>A few of the application where OpenCV is used include:
            <ul class="fa-ul">
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>Processing and stitching the images for Google Streetview.</li>
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>Monitoring of mining equipment in China</li>
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>Detecting potential drownings in pools</li>
              <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>Checking runways for debris</li>
            </ul>
          </p>
          <p>
            OpenCV can be used in C++, Python, Java and MATLAB and on different platforms, including
            Windows and Linux.
          </p>
          <p>
            OpenCV itself has been written in C++ and has to be compiled before it can be used in Python.
            Luckily there is a pre-compiled version available on PyPi. This version can be easily
            installed via PIP.<br>It is officially supported and maintained by the OpenCV developers, but is really easy to use.
            There is less control over the installation, as no option can be changed during the
            compilation. In most cases, however, this is also not needed. This will also reduce the
            chances for errors during the installation.
          </p>
          <p>OpenCV can be installed, via PIP, using the following command:</p>
          <pre><code><span class="terminal-first-highlight">pip</span> install opencv-python</code></pre>
          <p>
            This will always install the latest version. For this project OpenCV version 4.0.0 was used.
            A specific version can be installed by specifying which version pip should install.
          </p>
          <pre><code><span class="terminal-first-highlight">pip</span> install opencv-python <span class="terminal-number">4.0.0.21</span></code></pre>
          <p>The program was tested with newer version of OpenCV, so this should pose no problems.</p>
          <p>
            Both commands will install the same distribution that was used during the development of the
            program. There are different distributions available of OpenCV on PyPi. All of these can be
            easily installed.
          </p>
          <p>
            The difference between them, lays in the functionality they offer. The first distribution is
            the standard one, it has all the built-in functionality that OpenCV would normally have, if
            compiled it yourself.
          </p>
          <p>
            The distributions with <em>contrib</em> in their name, contain functionality that was written
            and developed by the community. These versions contain a lot more functionality but are also
            larger to install.
          </p>
          <p>
            The distributions with <em>headless</em> in their name, contain all functionality to process
            the frames, but they have no visualisation capabilities. They cannot display the results.
            These distributions are ideal to install on machines with no monitor attached, or machines
            that are controlled via a text-only interface (like the command-line or SSH).
          </p>
          <ul class="fa-ul">
            <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>opencv-python</li>
            <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>opencv-contrib-python</li>
            <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>opencv-python-headless</li>
            <li><span class="fa-li"><i class="fas fa-caret-right"></i></span>opencv-contrib-python-headless</li>
          </ul>
          <p>
            Since OpenCV itself is used for the visualisation of the results, in this project and no extra
            functionality is needed, the standard distribution can be installed.
          </p>
          <h4>Paho MQTT</h4>
          <p>
            Since the different parts of this project are connected together, via MQTT. A library is
            needed in order to connect to a broker and send the messages. For this purpose eclipse-paho
            was chosen. It is a lightweight module that does everything it is supposed to do.
          </p>
          <p>This module can be installed via the following command:</p>
          <pre><code><span class="terminal-first-highlight">pip</span> install paho-mqtt</code></pre>
          <h4>The Python Standard Library</h4>
          <p>text</p>
          <h4>PiCamera[array]</h4>
          <pre><code><span class="terminal-first-highlight">pip</span> install <span class="terminal-string">"picamera[array]"</span></code></pre>
        </section>
        <section id="vision-program">
          <h2>Program</h2>
          <h3>Structure</h3>
          <h3>Importing the libraries</h3>
          <div class="gist_container">
            <script src="https://gist.github.com/pcassima/52e732a9dd9516d296491bad7ec8bd18.js"></script>
            <!--label Importing the libraries-->
          </div>
          <h3>Classes</h3>
          <h4>Webcam class</h4>
          <h3>Functions</h3>
          <h4>order_66</h4>
          <h4>finished</h4>
          <h4>name_colour</h4>
          <h3>Main</h3>
          <h4>Read in a frame</h4>
          <h4>Convert to greyscale</h4>
          <h4>Gaussian blur</h4>
          <h4>Threshold</h4>
          <h4>Canny Edge Detection</h4>
          <h4>Contours</h4>
          <h4>Count corners & determine shape</h4>
          <h4>Calculate centre of shape</h4>
          <h4>Results</h4>
        </section>
      </article>
      <div>
        <div class="bottom_navbar">
          <div class="back"><a href="outline.html">&#171; back</a></div>
        </div>
        <div class="bottom_navbar">
          <div class="next"><a href="linefollower.html">next &#187;</a></div>
        </div>
      </div>
    </main>
    <footer>
      <div class="footer_column">
        <p>&copy 2019, Pieter-Jan Cassiman</p>
        <ul class="social_bar">
          <li><a class="fab fa-youtube fa-2x" href="https://www.youtube.com/channel/UCag4kR1A4hj4j2MgZwDUQLg" target="_blank"></a></li>
          <li><a class="fab fa-instagram fa-2x" href="https://www.instagram.com/pieterjancassiman/" target="_blank"></a></li>
          <li><a class="fab fa-github fa-2x" href="https://github.com/pcassima" target="_blank"></a></li>
          <li><a class="fab fa-blogger fa-2x" href="https://transistories.blogspot.com/" target="_blank"></a></li>
          <li><a class="fab fa-twitter fa-2x" href="https://twitter.com/PieterJanCassim" target="_blank"></a></li>
          <!--li-->
          <!--    a(href="https://www.reddit.com/user/pcassima" class="fab fa-reddit fa-2x" target="_blank")-->
        </ul>
      </div>
      <div class="footer_column">
        <form class="badge" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
          <input type="hidden" name="cmd" value="_s-xclick">
          <input type="hidden" name="hosted_button_id" value="ZD9SEDGQSKR3U">
          <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button"><img alt="" border="0" src="https://www.paypal.com/en_BE/i/scr/pixel.gif" width="1" height="1">
        </form><a class="badge" href="https://www.tindie.com/stores/fenixcomputers/?ref=offsite_badges&amp;utm_source=sellers_fenixcomputers&amp;utm_medium=badges&amp;utm_campaign=badge_medium" target="_blank"><img src="https://d2ss6ovg47m0r5.cloudfront.net/badges/tindie-mediums.png" alt="I sell on Tindie" width="150" height="78"></a>
      </div>
    </footer>
  </body>
</html>